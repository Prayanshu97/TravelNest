# TravelNest - Accommodation Listing Platform

TravelNest is a full-stack web application that allows users to create, view, and manage accommodation listings with features like image uploads, location mapping, ratings, and reviews.

## üåü Features

### Core Functionality
- **User Authentication**: Secure login/signup system with session management
- **Accommodation Listings**: Create, view, edit, and delete accommodation listings
- **Image Upload**: Cloudinary integration for image storage and management
- **Location Mapping**: Mapbox integration for geocoding and location display
- **Reviews & Ratings**: Users can add reviews with star ratings (1-5 stars)
- **Authorization**: Users can only modify their own listings and reviews

### Technical Features
- **Responsive Design**: Modern UI with CSS styling
- **Form Validation**: Server-side validation using Joi
- **Error Handling**: Comprehensive error handling and flash messages
- **Database Management**: MongoDB with Mongoose ODM
- **File Upload**: Multer middleware for handling file uploads

## üõ†Ô∏è Tech Stack

### Backend
- **Node.js** - Runtime environment
- **Express.js** - Web framework
- **MongoDB** - Database
- **Mongoose** - Object Data Modeling
- **Passport.js** - Authentication middleware
- **Multer** - File upload handling
- **Joi** - Data validation

### Frontend
- **EJS** - Template engine
- **CSS** - Styling
- **JavaScript** - Client-side functionality

### External Services
- **Cloudinary** - Image storage and management
- **Mapbox** - Geocoding and mapping services

## üöÄ Installation & Setup

### Prerequisites
- Node.js (v18.17.0 or higher)
- MongoDB Atlas account
- Cloudinary account
- Mapbox account

### Environment Variables
Create a `.env` file in the root directory with the following variables:

```env
ATLASDB_URL=your_mongodb_atlas_connection_string
SECRET=your_session_secret
CLOUD_NAME=your_cloudinary_cloud_name
CLOUD_API_KEY=your_cloudinary_api_key
CLOUD_API_SECRET=your_cloudinary_api_secret
MAP_TOKEN=your_mapbox_access_token
```

### Installation Steps

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd TravelNest
   ```

2. **Install dependencies**
   ```bash
   npm install
   ```

3. **Set up environment variables**
   - Create a `.env` file with the required variables
   - Get your API keys from Cloudinary and Mapbox

4. **Start the application**
   ```bash
   node app.js
   ```

5. **Access the application**
   - Open your browser and navigate to `http://localhost:8080`

## üìã API Endpoints

### Listings
- `GET /listings` - View all listings
- `GET /listings/new` - Create new listing form
- `POST /listings` - Create new listing
- `GET /listings/:id` - View specific listing
- `GET /listings/:id/edit` - Edit listing form
- `PUT /listings/:id` - Update listing
- `DELETE /listings/:id` - Delete listing

### Reviews
- `POST /listings/:id/reviews` - Add review to listing
- `DELETE /listings/:id/reviews/:reviewId` - Delete review

### Users
- `GET /signup` - User registration form
- `POST /signup` - Register new user
- `GET /login` - Login form
- `POST /login` - User login
- `GET /logout` - User logout

## üîê Authentication & Authorization

### User Authentication
- Uses Passport.js with local strategy
- Session-based authentication
- Flash messages for user feedback

### Authorization Rules
- Users must be logged in to create listings and reviews
- Users can only edit/delete their own listings
- Users can only delete their own reviews
- Guest users can view listings and reviews

## üóÑÔ∏è Database Schema

### Listing Model
```javascript
{
  title: String (required),
  description: String,
  image: {
    url: String,
    filename: String
  },
  price: Number,
  location: String,
  country: String,
  reviews: [Review ObjectIds],
  owner: User ObjectId,
  geometry: {
    type: 'Point',
    coordinates: [Number, Number]
  }
}
```

### Review Model
```javascript
{
  comment: String,
  rating: Number (1-5),
  createdAt: Date,
  author: User ObjectId
}
```

### User Model
```javascript
{
  email: String (required),
  username: String (auto-generated by passport-local-mongoose)
}
```

## üé® Features in Detail

### Image Upload
- Uses Multer with Cloudinary storage
- Supports PNG, JPEG, JPG formats
- Automatic image optimization
- Secure file handling

### Location Services
- Mapbox geocoding for address to coordinates conversion
- Interactive map display
- Location-based listing search

### Review System
- Star rating system (1-5 stars)
- Comment functionality
- Author attribution
- Cascade deletion (reviews deleted when listing is deleted)

### Form Validation
- Client-side and server-side validation
- Joi schema validation
- Custom error messages
- Input sanitization

## üõ°Ô∏è Security Features

- **Session Management**: Secure session storage with MongoDB
- **Input Validation**: Server-side validation for all inputs
- **File Upload Security**: Restricted file types and sizes
- **Authorization**: Role-based access control
- **CSRF Protection**: Built-in Express.js protection
- **Environment Variables**: Secure configuration management

## üöÄ Deployment

### Local Development
```bash
npm start
# or
node app.js
```

### Production Deployment
1. Set up a MongoDB Atlas cluster
2. Configure Cloudinary for image storage
3. Set up Mapbox API keys
4. Deploy to your preferred hosting platform (Heroku, Vercel, etc.)
5. Set environment variables in production
